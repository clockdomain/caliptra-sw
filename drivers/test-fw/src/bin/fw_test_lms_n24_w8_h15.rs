/*++

Licensed under the Apache-2.0 license.

Abstract:

    File contains test cases for LMS signature verification. This file is machine generated.

--*/

#![no_std]
#![no_main]

use caliptra_drivers::{Lms, LmsResult, Sha256};
use caliptra_lms_types::{LmsPublicKey, LmsSignature};
use caliptra_registers::sha256::Sha256Reg;
use caliptra_test_harness::test_suite;

struct LmsTest<'a> {
    test_passed: bool,
    signature: &'a [u8],
}

fn test_lms_random_suite() {
    let mut sha256 = unsafe { Sha256::new(Sha256Reg::new()) };
    	const MESSAGE :[u8; 33] = [116, 104, 105, 115, 32, 105, 115, 32, 116, 104, 101, 32, 109, 101, 115, 115, 97, 103, 101, 32, 73, 32, 119, 97, 110, 116, 32, 115, 105, 103, 110, 101, 100];
	const PUBLIC_KEY_BYTES: [u8; 48] = [0, 0, 0, 12, 0, 0, 0, 8, 240, 30, 118, 103, 59, 195, 144, 113, 231, 38, 69, 160, 132, 143, 167, 209, 104, 192, 18, 245, 83, 189, 181, 228, 33, 119, 184, 169, 73, 186, 21, 120, 116, 170, 225, 117, 78, 158, 106, 80];
	let (head, thing1, _tail): (&[u8], &[LmsPublicKey<6>], &[u8]) = unsafe { PUBLIC_KEY_BYTES.align_to::<LmsPublicKey<6>>() };
    	assert!(head.is_empty());
    	let lms_public_key = thing1[0];
	const TESTS: [LmsTest; 2] = [
		LmsTest{ test_passed: true, signature: &[0, 0, 103, 92, 0, 0, 0, 8, 56, 193, 116, 64, 149, 90, 236, 205, 73, 96, 192, 119, 11, 197, 77, 168, 101, 12, 88, 243, 37, 124, 66, 100, 165, 255, 54, 183, 131, 32, 112, 232, 145, 104, 171, 52, 160, 117, 98, 85, 195, 55, 119, 27, 231, 15, 14, 28, 171, 106, 203, 141, 14, 65, 246, 72, 48, 127, 130, 141, 137, 186, 222, 27, 73, 122, 12, 187, 236, 251, 89, 140, 174, 175, 159, 251, 95, 190, 205, 41, 15, 238, 177, 151, 36, 27, 117, 23, 96, 212, 230, 203, 7, 203, 65, 122, 132, 191, 62, 224, 31, 162, 71, 145, 110, 30, 174, 17, 34, 5, 246, 248, 137, 174, 70, 1, 151, 84, 0, 237, 146, 66, 245, 234, 61, 177, 134, 187, 203, 230, 46, 109, 207, 72, 178, 227, 19, 150, 198, 48, 169, 254, 221, 123, 75, 76, 96, 81, 227, 235, 169, 93, 236, 232, 235, 24, 243, 31, 139, 120, 15, 144, 38, 226, 102, 111, 15, 69, 44, 13, 138, 137, 30, 74, 72, 45, 74, 183, 53, 85, 87, 181, 115, 95, 186, 144, 102, 61, 25, 23, 218, 78, 63, 153, 115, 220, 220, 108, 88, 70, 232, 149, 200, 105, 52, 158, 98, 182, 114, 31, 237, 132, 152, 79, 96, 201, 234, 47, 102, 161, 155, 159, 146, 16, 190, 221, 118, 239, 211, 23, 176, 210, 164, 255, 196, 254, 38, 117, 231, 45, 81, 232, 127, 53, 145, 44, 20, 177, 94, 146, 233, 93, 81, 168, 193, 115, 184, 158, 189, 65, 0, 76, 73, 80, 56, 98, 70, 145, 81, 88, 131, 15, 176, 170, 10, 67, 35, 108, 154, 223, 201, 132, 249, 170, 115, 39, 120, 31, 186, 10, 61, 44, 12, 212, 224, 38, 170, 188, 176, 103, 15, 141, 57, 17, 213, 8, 207, 221, 125, 179, 237, 35, 235, 66, 255, 215, 179, 242, 215, 164, 145, 121, 210, 221, 188, 189, 70, 145, 213, 5, 71, 88, 111, 118, 180, 88, 44, 88, 202, 101, 215, 248, 51, 33, 238, 15, 224, 82, 230, 222, 200, 190, 243, 83, 62, 140, 85, 102, 158, 175, 189, 72, 233, 66, 104, 189, 105, 43, 72, 188, 177, 164, 222, 1, 13, 239, 72, 171, 83, 146, 204, 88, 48, 12, 51, 8, 118, 94, 165, 196, 154, 241, 116, 2, 238, 77, 52, 219, 250, 100, 85, 253, 98, 52, 193, 124, 142, 193, 130, 65, 51, 76, 52, 247, 253, 104, 238, 57, 211, 246, 49, 36, 129, 52, 178, 192, 48, 38, 70, 88, 187, 166, 95, 232, 85, 51, 41, 210, 66, 11, 217, 81, 10, 130, 133, 75, 54, 29, 19, 173, 9, 148, 166, 95, 26, 152, 189, 134, 34, 136, 7, 20, 178, 250, 238, 217, 14, 18, 24, 116, 8, 176, 230, 234, 101, 46, 142, 184, 54, 227, 157, 113, 246, 30, 135, 191, 46, 126, 20, 59, 61, 150, 23, 187, 109, 243, 156, 134, 208, 169, 128, 10, 143, 10, 252, 128, 228, 77, 37, 2, 179, 180, 18, 16, 25, 15, 76, 73, 101, 146, 162, 190, 7, 79, 94, 72, 244, 72, 0, 87, 200, 125, 97, 199, 7, 147, 28, 182, 111, 47, 76, 35, 7, 231, 20, 138, 10, 38, 175, 214, 5, 125, 11, 85, 194, 137, 97, 150, 122, 35, 117, 228, 2, 146, 37, 152, 215, 113, 233, 3, 191, 54, 25, 239, 220, 154, 147, 171, 44, 150, 255, 234, 25, 143, 232, 118, 95, 55, 12, 110, 14, 154, 228, 138, 44, 156, 175, 208, 27, 7, 205, 171, 222, 29, 67, 224, 150, 81, 231, 4, 107, 112, 172, 169, 55, 243, 102, 163, 237, 58, 42, 208, 23, 63, 175, 206, 188, 153, 79, 32, 136, 235, 216, 35, 159, 67, 247, 126, 64, 128, 24, 117, 125, 132, 28, 149, 91, 148, 0, 0, 0, 12, 180, 23, 244, 160, 190, 87, 208, 1, 26, 97, 237, 148, 108, 3, 94, 107, 82, 176, 193, 118, 45, 40, 123, 191, 95, 143, 183, 146, 25, 146, 84, 117, 187, 185, 80, 48, 25, 71, 139, 176, 231, 175, 103, 244, 248, 211, 76, 105, 210, 46, 2, 109, 33, 123, 240, 65, 13, 155, 45, 10, 248, 141, 192, 199, 251, 243, 107, 216, 130, 250, 87, 99, 192, 22, 7, 135, 231, 251, 120, 106, 205, 236, 150, 206, 194, 82, 83, 136, 191, 166, 174, 84, 82, 28, 27, 65, 88, 151, 146, 89, 74, 74, 95, 229, 115, 220, 126, 79, 150, 62, 114, 142, 34, 72, 88, 52, 176, 14, 162, 158, 138, 45, 201, 56, 221, 255, 22, 90, 241, 68, 107, 2, 253, 251, 116, 111, 203, 189, 162, 137, 38, 159, 160, 179, 142, 87, 171, 67, 116, 28, 147, 236, 236, 35, 221, 219, 247, 122, 241, 150, 83, 201, 184, 72, 239, 74, 164, 28, 73, 4, 74, 54, 18, 209, 99, 247, 16, 39, 93, 67, 68, 71, 128, 5, 60, 163, 139, 186, 234, 126, 174, 84, 161, 8, 143, 67, 204, 141, 233, 243, 180, 35, 15, 115, 145, 147, 249, 9, 191, 116, 24, 172, 123, 54, 192, 109, 213, 66, 132, 235, 163, 25, 88, 26, 220, 50, 158, 26, 98, 99, 241, 142, 27, 200, 50, 79, 13, 116, 254, 91, 100, 32, 117, 224, 206, 108, 5, 231, 195, 204, 221, 9, 88, 110, 69, 164, 86, 213, 202, 250, 162, 3, 99, 244, 219, 146, 226, 16, 35, 139, 244, 132, 0, 187, 65, 43, 21, 32, 9, 0, 217, 185, 251, 6, 164, 228, 135, 236, 6, 97, 19, 149, 202, 190, 45, 54, 29, 63, 160, 23, 39, 251, 243, 41, 247, 70, 154, 107, 85, 102, 82, 239, 77, 58, 6, 127, 175, 82, 30, 224, 179, 169, 50, 8, 175, 250, 253, 231, 237, 64, 203, 45, 156, 87, 192, 145, 9, 156, 127, 254, 165, 207, 5, 152, 53, 42, 244, 115, 154, 12, 8, 163, 112, 96, 165, 204, 155, 222, 171, 113]},
		LmsTest{ test_passed: true, signature: &[0, 0, 87, 79, 0, 0, 0, 8, 17, 82, 68, 178, 216, 19, 227, 211, 107, 44, 139, 20, 201, 77, 251, 6, 17, 209, 101, 22, 150, 103, 243, 27, 51, 135, 42, 102, 49, 158, 18, 12, 232, 58, 253, 67, 236, 203, 206, 37, 183, 152, 160, 243, 24, 250, 42, 56, 113, 164, 205, 100, 46, 33, 155, 73, 39, 117, 181, 29, 235, 116, 157, 109, 30, 157, 248, 102, 112, 101, 88, 107, 61, 107, 13, 231, 17, 216, 0, 13, 15, 121, 102, 4, 150, 183, 29, 253, 73, 37, 204, 154, 158, 178, 196, 230, 174, 43, 162, 230, 214, 83, 204, 192, 198, 198, 36, 76, 169, 95, 69, 52, 242, 78, 64, 215, 255, 3, 95, 183, 104, 191, 185, 96, 41, 208, 174, 6, 145, 21, 40, 215, 10, 232, 61, 202, 95, 156, 223, 4, 190, 55, 222, 249, 97, 228, 203, 131, 142, 251, 0, 238, 92, 212, 130, 74, 228, 76, 133, 92, 109, 251, 131, 123, 203, 220, 150, 116, 84, 92, 203, 82, 199, 165, 33, 158, 87, 6, 253, 65, 95, 177, 87, 231, 199, 204, 59, 39, 34, 128, 79, 125, 184, 191, 8, 92, 82, 26, 98, 54, 171, 31, 177, 59, 254, 255, 54, 57, 76, 241, 43, 142, 85, 85, 210, 129, 40, 200, 54, 132, 190, 87, 86, 92, 238, 236, 133, 185, 21, 38, 188, 87, 165, 93, 143, 98, 89, 156, 247, 54, 232, 104, 1, 42, 195, 20, 105, 246, 32, 74, 216, 170, 150, 251, 132, 145, 106, 114, 62, 109, 48, 115, 224, 40, 127, 120, 104, 217, 90, 181, 89, 70, 77, 83, 186, 130, 100, 58, 24, 8, 213, 82, 158, 50, 184, 246, 155, 58, 14, 188, 118, 81, 42, 12, 119, 19, 4, 89, 182, 99, 197, 221, 103, 21, 212, 3, 2, 62, 255, 110, 61, 241, 183, 212, 231, 254, 186, 181, 39, 22, 150, 44, 241, 173, 110, 159, 222, 237, 102, 99, 217, 194, 238, 29, 196, 240, 153, 18, 150, 178, 81, 65, 247, 162, 24, 45, 76, 90, 114, 9, 223, 56, 83, 50, 71, 176, 98, 146, 136, 234, 157, 127, 219, 226, 92, 52, 116, 84, 176, 40, 243, 253, 157, 100, 180, 152, 143, 243, 192, 92, 6, 188, 9, 17, 36, 166, 210, 173, 16, 100, 168, 235, 200, 34, 41, 246, 238, 60, 64, 29, 24, 193, 41, 37, 85, 1, 96, 39, 32, 166, 36, 249, 24, 226, 22, 54, 65, 85, 252, 123, 65, 117, 83, 15, 85, 131, 195, 192, 220, 98, 2, 47, 241, 43, 131, 216, 215, 221, 113, 240, 139, 72, 255, 114, 186, 244, 131, 142, 231, 71, 68, 105, 253, 193, 191, 183, 10, 16, 80, 43, 155, 220, 83, 155, 105, 138, 238, 47, 97, 235, 250, 28, 119, 2, 41, 20, 240, 163, 165, 112, 184, 168, 119, 157, 67, 11, 98, 75, 29, 112, 210, 11, 184, 27, 249, 160, 226, 22, 218, 46, 25, 221, 74, 168, 77, 240, 201, 255, 143, 111, 131, 7, 142, 246, 155, 154, 205, 230, 120, 104, 81, 13, 128, 18, 190, 159, 106, 3, 147, 44, 32, 165, 246, 62, 255, 61, 68, 225, 95, 39, 158, 251, 4, 22, 37, 173, 111, 110, 243, 45, 252, 212, 167, 96, 180, 32, 147, 186, 2, 48, 83, 165, 190, 33, 252, 8, 145, 207, 198, 25, 215, 151, 156, 51, 234, 137, 123, 237, 223, 80, 27, 209, 176, 50, 166, 150, 105, 104, 53, 226, 249, 156, 142, 160, 40, 60, 164, 176, 5, 61, 137, 129, 83, 85, 118, 69, 97, 221, 41, 64, 29, 24, 120, 156, 152, 33, 187, 146, 102, 33, 168, 65, 178, 207, 156, 129, 69, 129, 92, 27, 20, 169, 195, 72, 229, 34, 179, 9, 201, 185, 251, 222, 87, 29, 82, 54, 39, 223, 0, 0, 0, 12, 9, 185, 188, 12, 193, 99, 200, 34, 105, 213, 134, 156, 203, 119, 208, 24, 187, 132, 96, 137, 122, 238, 59, 51, 212, 191, 234, 146, 172, 199, 56, 231, 135, 182, 218, 19, 64, 230, 247, 154, 112, 72, 73, 243, 119, 23, 6, 207, 247, 43, 38, 13, 192, 216, 139, 61, 237, 53, 53, 171, 85, 49, 15, 177, 27, 159, 210, 239, 36, 163, 145, 220, 166, 240, 226, 15, 211, 82, 137, 175, 91, 238, 68, 223, 242, 68, 72, 57, 19, 148, 127, 207, 99, 193, 239, 246, 141, 151, 107, 127, 15, 160, 8, 30, 45, 17, 250, 189, 22, 254, 173, 171, 13, 99, 18, 224, 42, 220, 191, 140, 100, 122, 32, 252, 129, 48, 16, 214, 28, 179, 137, 205, 119, 83, 144, 44, 208, 75, 49, 44, 196, 80, 178, 10, 19, 238, 236, 222, 59, 204, 87, 58, 200, 58, 224, 15, 56, 162, 225, 129, 19, 197, 223, 78, 125, 176, 52, 105, 177, 244, 123, 187, 40, 188, 133, 242, 84, 202, 226, 130, 78, 158, 185, 253, 137, 241, 6, 82, 67, 216, 78, 199, 100, 132, 94, 23, 78, 35, 8, 61, 94, 55, 160, 237, 248, 53, 252, 252, 114, 69, 111, 99, 204, 166, 241, 216, 112, 94, 57, 169, 143, 10, 20, 90, 183, 187, 60, 38, 205, 193, 242, 218, 142, 44, 200, 60, 91, 67, 78, 100, 191, 220, 137, 153, 190, 116, 80, 129, 28, 83, 218, 180, 247, 229, 5, 158, 3, 51, 155, 60, 218, 62, 117, 94, 21, 253, 72, 239, 43, 196, 54, 9, 225, 252, 129, 114, 0, 101, 233, 62, 82, 106, 146, 70, 183, 110, 252, 238, 223, 28, 122, 129, 56, 152, 82, 106, 96, 48, 189, 80, 88, 113, 139, 167, 98, 18, 198, 223, 6, 58, 94, 180, 64, 145, 20, 72, 38, 24, 91, 126, 179, 156, 123, 54, 53, 210, 104, 55, 113, 159, 61, 12, 150, 94, 54, 111, 9, 156, 127, 254, 165, 207, 5, 152, 53, 42, 244, 115, 154, 12, 8, 163, 112, 96, 165, 204, 155, 222, 171, 113]},
	];
	for t in TESTS {
        let (head, thing2, _tail): (&[u8], &[LmsSignature<6, 26, 15>], &[u8]) =
            unsafe { t.signature.align_to::<LmsSignature<6, 26, 15>>() };

        assert!(head.is_empty());
        let lms_sig = thing2[0];
        let verify_result = Lms::default().verify_lms_signature_generic(
            &mut sha256,
            &MESSAGE,
            &lms_public_key,
            &lms_sig,
        );
        if t.test_passed {
            // if the test is supposed to pass then we better have no errors and a successful verification
            let result = verify_result.unwrap();
            assert_eq!(result, LmsResult::Success)
        } else {
            // if the test is supposed to fail it could be for a number of reasons that could raise a variety of errors
            // if the verification didn't error, then extract the LMS result and ensure it is a failed verification
            if verify_result.is_ok() {
                let result = verify_result.unwrap();
                assert_eq!(result, LmsResult::SigVerifyFailed)
            }
        }
    }
}

test_suite! {
    test_lms_random_suite,
}
