/*++

Licensed under the Apache-2.0 license.

Abstract:

    File contains test cases for LMS signature verification. This file is machine generated.

--*/

#![no_std]
#![no_main]

use caliptra_drivers::{Lms, LmsResult, Sha256};
use caliptra_lms_types::{LmsPublicKey, LmsSignature};
use caliptra_registers::sha256::Sha256Reg;
use caliptra_test_harness::test_suite;

struct LmsTest<'a> {
    test_passed: bool,
    signature: &'a [u8],
}

fn test_lms_random_suite() {
    let mut sha256 = unsafe { Sha256::new(Sha256Reg::new()) };
    	const MESSAGE :[u8; 33] = [116, 104, 105, 115, 32, 105, 115, 32, 116, 104, 101, 32, 109, 101, 115, 115, 97, 103, 101, 32, 73, 32, 119, 97, 110, 116, 32, 115, 105, 103, 110, 101, 100];
	const PUBLIC_KEY_BYTES: [u8; 56] = [0, 0, 0, 6, 0, 0, 0, 4, 72, 179, 50, 161, 81, 228, 109, 214, 42, 33, 169, 227, 80, 165, 228, 51, 95, 246, 222, 244, 250, 46, 14, 243, 177, 156, 46, 6, 229, 246, 97, 36, 11, 28, 201, 203, 14, 173, 197, 35, 82, 93, 150, 118, 152, 64, 132, 8];
	let (head, thing1, _tail): (&[u8], &[LmsPublicKey<8>], &[u8]) = unsafe { PUBLIC_KEY_BYTES.align_to::<LmsPublicKey<8>>() };
    	assert!(head.is_empty());
    	let lms_public_key = thing1[0];
	const TESTS: [LmsTest; 2] = [
		LmsTest{ test_passed: true, signature: &[0, 0, 3, 193, 0, 0, 0, 4, 64, 188, 16, 83, 40, 55, 79, 167, 241, 170, 243, 180, 81, 245, 223, 162, 59, 232, 5, 24, 150, 195, 158, 107, 31, 90, 5, 227, 66, 135, 221, 79, 138, 253, 224, 235, 100, 231, 43, 32, 207, 101, 190, 171, 254, 7, 213, 5, 24, 1, 222, 106, 123, 69, 72, 117, 147, 124, 218, 248, 249, 128, 203, 116, 20, 117, 65, 21, 109, 251, 198, 129, 203, 181, 23, 75, 12, 63, 225, 118, 166, 16, 220, 114, 50, 83, 151, 204, 144, 81, 10, 85, 183, 2, 223, 137, 15, 245, 20, 30, 131, 217, 84, 253, 201, 96, 124, 8, 149, 123, 200, 32, 207, 81, 212, 124, 226, 46, 218, 222, 122, 18, 2, 24, 36, 191, 88, 59, 230, 70, 90, 73, 166, 231, 185, 219, 7, 2, 12, 149, 111, 193, 133, 200, 81, 162, 152, 167, 109, 116, 107, 113, 152, 190, 212, 237, 100, 66, 179, 42, 88, 32, 115, 246, 252, 83, 76, 181, 150, 87, 212, 134, 30, 215, 26, 121, 77, 76, 95, 111, 109, 179, 245, 43, 113, 154, 246, 185, 194, 183, 139, 25, 248, 36, 190, 209, 47, 90, 208, 128, 149, 112, 89, 153, 208, 129, 114, 130, 147, 151, 81, 207, 150, 22, 22, 0, 0, 183, 44, 206, 161, 119, 92, 41, 242, 255, 163, 153, 77, 16, 77, 178, 245, 79, 160, 60, 188, 12, 75, 125, 201, 108, 36, 8, 219, 126, 228, 82, 185, 204, 199, 83, 47, 143, 12, 221, 14, 107, 116, 155, 34, 47, 243, 146, 86, 93, 30, 11, 248, 97, 223, 213, 186, 197, 39, 148, 189, 27, 240, 73, 54, 205, 145, 39, 132, 164, 129, 45, 21, 120, 207, 247, 94, 241, 217, 24, 171, 111, 93, 170, 149, 98, 254, 122, 195, 199, 213, 82, 169, 109, 194, 72, 195, 96, 123, 107, 86, 211, 40, 254, 123, 45, 34, 176, 104, 241, 84, 91, 132, 0, 227, 131, 244, 144, 255, 64, 13, 231, 179, 4, 199, 84, 134, 246, 80, 95, 46, 111, 127, 207, 196, 206, 42, 255, 21, 187, 23, 168, 136, 213, 31, 128, 51, 206, 52, 73, 170, 248, 56, 63, 247, 124, 15, 228, 118, 192, 182, 8, 55, 114, 65, 64, 146, 184, 33, 32, 217, 190, 18, 31, 114, 64, 182, 75, 48, 212, 67, 72, 84, 188, 20, 214, 48, 96, 119, 197, 1, 54, 142, 41, 108, 132, 213, 34, 48, 182, 225, 124, 156, 190, 213, 88, 68, 157, 245, 15, 154, 114, 23, 255, 125, 255, 163, 23, 218, 57, 15, 148, 21, 227, 70, 36, 172, 128, 186, 151, 93, 157, 73, 8, 127, 118, 34, 246, 206, 215, 162, 209, 193, 56, 213, 105, 237, 249, 152, 227, 128, 57, 28, 64, 135, 194, 129, 88, 19, 50, 229, 197, 78, 0, 157, 198, 219, 192, 121, 92, 188, 32, 100, 194, 111, 154, 199, 50, 72, 17, 41, 130, 26, 32, 208, 141, 10, 31, 150, 241, 98, 161, 240, 60, 82, 149, 153, 77, 187, 233, 177, 163, 63, 163, 97, 49, 187, 80, 188, 76, 99, 132, 44, 103, 35, 121, 238, 132, 160, 78, 107, 31, 13, 82, 167, 220, 25, 200, 57, 251, 111, 51, 147, 151, 195, 64, 45, 247, 255, 123, 10, 144, 25, 46, 77, 182, 28, 179, 179, 85, 212, 236, 237, 165, 143, 11, 25, 237, 177, 18, 119, 70, 248, 72, 97, 162, 74, 57, 221, 18, 174, 198, 244, 139, 7, 167, 242, 219, 186, 117, 188, 36, 153, 106, 179, 166, 29, 131, 152, 28, 246, 14, 1, 182, 247, 81, 62, 170, 214, 76, 233, 240, 57, 241, 147, 192, 146, 3, 61, 2, 128, 192, 62, 236, 136, 151, 250, 21, 150, 41, 7, 230, 35, 218, 192, 7, 118, 208, 201, 43, 104, 11, 13, 50, 60, 12, 61, 143, 117, 70, 10, 64, 57, 96, 224, 53, 88, 103, 221, 217, 143, 91, 72, 109, 227, 229, 74, 151, 242, 126, 71, 132, 53, 110, 121, 183, 209, 167, 116, 188, 107, 115, 195, 109, 18, 83, 216, 149, 224, 78, 65, 221, 102, 64, 69, 162, 219, 195, 137, 78, 234, 130, 46, 169, 16, 162, 14, 1, 56, 10, 230, 90, 229, 89, 210, 27, 34, 201, 251, 245, 60, 235, 139, 81, 230, 22, 177, 14, 54, 201, 140, 155, 80, 216, 164, 190, 127, 175, 145, 21, 127, 181, 191, 28, 22, 45, 126, 238, 50, 241, 10, 189, 69, 27, 95, 249, 140, 198, 27, 253, 54, 66, 87, 152, 43, 15, 182, 170, 8, 7, 129, 34, 155, 206, 132, 39, 83, 114, 45, 139, 129, 132, 75, 157, 59, 197, 197, 172, 36, 200, 85, 158, 157, 236, 158, 162, 33, 214, 147, 150, 97, 250, 10, 94, 44, 108, 182, 102, 135, 122, 65, 213, 176, 128, 57, 63, 30, 154, 180, 1, 200, 69, 98, 36, 242, 99, 246, 48, 151, 15, 247, 172, 89, 112, 204, 99, 177, 187, 211, 96, 142, 15, 8, 73, 176, 173, 198, 72, 168, 231, 163, 175, 254, 121, 237, 12, 119, 183, 243, 38, 41, 125, 251, 141, 233, 165, 15, 133, 127, 113, 56, 202, 23, 167, 53, 104, 48, 18, 122, 67, 214, 15, 163, 90, 117, 68, 50, 64, 176, 183, 211, 110, 237, 79, 67, 132, 134, 38, 178, 252, 69, 151, 78, 142, 195, 138, 53, 194, 80, 151, 201, 5, 211, 26, 9, 197, 175, 71, 2, 24, 29, 184, 16, 144, 88, 30, 158, 245, 169, 55, 143, 35, 221, 9, 98, 1, 112, 6, 87, 161, 117, 107, 189, 24, 149, 108, 214, 14, 2, 148, 79, 141, 21, 199, 219, 29, 64, 164, 148, 43, 199, 22, 212, 155, 29, 242, 102, 231, 51, 134, 181, 49, 42, 228, 45, 247, 53, 245, 254, 40, 228, 71, 71, 227, 7, 182, 201, 17, 230, 84, 17, 58, 171, 88, 12, 6, 62, 231, 71, 167, 184, 208, 3, 70, 25, 167, 211, 167, 236, 0, 123, 213, 1, 7, 178, 201, 53, 136, 64, 78, 187, 25, 25, 76, 53, 137, 46, 187, 189, 80, 138, 145, 53, 185, 243, 24, 130, 92, 101, 2, 15, 84, 31, 150, 56, 43, 37, 96, 212, 19, 42, 179, 126, 194, 192, 252, 52, 130, 152, 215, 13, 71, 229, 232, 131, 180, 142, 205, 144, 79, 106, 107, 140, 119, 92, 87, 192, 168, 55, 187, 251, 60, 163, 49, 0, 136, 15, 249, 216, 81, 232, 207, 83, 76, 231, 130, 143, 234, 165, 254, 135, 171, 125, 5, 130, 243, 117, 18, 121, 45, 20, 72, 170, 124, 0, 0, 0, 6, 66, 178, 172, 74, 154, 221, 133, 234, 230, 183, 10, 106, 210, 154, 2, 188, 163, 31, 81, 87, 130, 189, 161, 21, 23, 186, 89, 232, 83, 54, 167, 146, 1, 124, 57, 192, 31, 73, 207, 221, 83, 22, 48, 197, 90, 21, 250, 38, 195, 182, 116, 161, 205, 29, 146, 134, 15, 64, 157, 189, 97, 103, 37, 247, 84, 208, 20, 82, 213, 91, 71, 125, 138, 132, 131, 56, 140, 218, 151, 164, 105, 189, 158, 79, 39, 127, 96, 209, 141, 121, 22, 5, 195, 223, 10, 214, 36, 16, 119, 216, 73, 218, 205, 236, 67, 180, 37, 135, 233, 244, 181, 10, 141, 188, 136, 16, 59, 56, 101, 91, 18, 6, 154, 66, 239, 24, 21, 232, 128, 123, 68, 78, 137, 166, 135, 44, 80, 181, 82, 180, 196, 218, 233, 220, 123, 93, 55, 49, 114, 21, 163, 42, 64, 75, 236, 47, 4, 120, 174, 75, 133, 173, 156, 91, 128, 84, 82, 250, 115, 172, 179, 19, 175, 99, 205, 109, 76, 14, 55, 242, 118, 207, 102, 139, 141, 217, 214, 62, 199, 167, 61, 249, 170, 221, 4, 221, 202, 117, 66, 105, 101, 170, 212, 66, 235, 173, 45, 6, 216, 190, 236, 36, 174, 141, 59, 254, 130, 123, 35, 233, 234, 209, 134, 71, 161, 240, 58, 80, 57, 190, 222, 173, 3, 122, 56, 177, 251, 185, 87, 163, 178, 116, 69, 145, 150, 247, 239, 84, 149, 212, 209, 48, 7, 83, 210, 94, 202, 180, 168, 36, 145, 143, 128, 31, 159, 1, 253, 13, 115, 109, 121, 153, 112, 190, 209, 30, 77, 183, 161, 238, 30, 42, 86, 159, 69, 13, 196, 217, 173, 161, 90, 79, 220, 133, 115, 31, 6, 88, 11, 223, 242, 56, 183, 117, 156, 44, 63, 114, 57, 8, 119, 136, 245, 169, 222, 168, 0, 89, 85, 36]},
		LmsTest{ test_passed: true, signature: &[0, 0, 1, 197, 0, 0, 0, 4, 126, 196, 195, 231, 114, 123, 80, 31, 0, 226, 229, 115, 181, 220, 11, 88, 47, 217, 30, 126, 21, 78, 237, 238, 135, 145, 154, 117, 224, 51, 67, 148, 0, 153, 45, 25, 28, 183, 5, 253, 58, 155, 17, 166, 54, 164, 109, 115, 244, 76, 29, 85, 198, 45, 47, 66, 143, 93, 187, 82, 131, 192, 19, 111, 119, 22, 48, 195, 149, 239, 163, 233, 106, 128, 64, 234, 14, 8, 64, 208, 188, 199, 81, 145, 156, 142, 15, 203, 151, 103, 188, 67, 97, 109, 6, 90, 24, 83, 148, 168, 192, 247, 61, 196, 46, 61, 236, 164, 13, 0, 97, 167, 235, 163, 107, 241, 88, 197, 171, 232, 138, 108, 233, 44, 87, 43, 163, 69, 54, 227, 138, 109, 176, 160, 217, 98, 89, 76, 188, 41, 224, 245, 19, 76, 99, 6, 213, 185, 216, 134, 199, 14, 32, 40, 199, 206, 71, 180, 145, 198, 186, 254, 212, 218, 72, 184, 78, 12, 65, 240, 254, 166, 223, 190, 42, 40, 133, 194, 254, 142, 82, 228, 138, 220, 186, 244, 211, 188, 144, 163, 45, 122, 153, 124, 122, 139, 188, 49, 158, 187, 92, 46, 247, 202, 163, 40, 54, 103, 208, 110, 110, 199, 18, 187, 75, 85, 189, 111, 7, 228, 172, 134, 72, 181, 94, 26, 7, 202, 203, 85, 250, 232, 111, 15, 181, 212, 123, 12, 128, 102, 6, 50, 221, 123, 170, 145, 212, 127, 125, 226, 59, 38, 58, 111, 25, 26, 25, 244, 229, 122, 144, 105, 173, 16, 163, 68, 107, 106, 56, 106, 194, 84, 218, 59, 134, 153, 70, 241, 60, 158, 239, 129, 191, 98, 150, 143, 241, 239, 12, 222, 34, 14, 247, 151, 124, 253, 131, 8, 75, 83, 103, 41, 136, 116, 77, 93, 27, 118, 117, 168, 131, 21, 3, 148, 199, 4, 4, 71, 3, 253, 157, 194, 167, 74, 89, 27, 59, 163, 18, 40, 130, 96, 50, 50, 237, 159, 6, 25, 22, 182, 134, 228, 13, 48, 3, 133, 84, 182, 189, 15, 195, 223, 208, 13, 180, 91, 32, 120, 54, 235, 40, 222, 202, 64, 159, 70, 74, 242, 33, 6, 222, 247, 106, 77, 152, 70, 129, 53, 150, 169, 163, 41, 64, 161, 237, 79, 1, 41, 172, 251, 197, 211, 141, 38, 191, 3, 6, 109, 170, 89, 24, 4, 127, 130, 203, 116, 114, 187, 92, 168, 86, 170, 209, 21, 80, 139, 118, 148, 42, 48, 108, 174, 122, 143, 180, 90, 18, 30, 162, 87, 169, 89, 59, 17, 142, 140, 237, 79, 72, 207, 193, 190, 137, 246, 144, 245, 44, 33, 255, 56, 230, 47, 124, 22, 109, 137, 46, 97, 92, 23, 245, 87, 9, 15, 69, 165, 47, 81, 114, 193, 179, 74, 219, 44, 89, 147, 3, 141, 122, 44, 188, 248, 89, 166, 166, 201, 150, 214, 58, 160, 70, 53, 18, 196, 199, 75, 131, 153, 62, 25, 28, 9, 240, 135, 68, 15, 233, 205, 122, 49, 21, 205, 137, 109, 151, 13, 21, 247, 23, 190, 52, 160, 62, 165, 101, 89, 165, 141, 94, 61, 125, 67, 35, 27, 119, 54, 148, 74, 151, 190, 21, 167, 77, 60, 7, 190, 217, 134, 118, 206, 102, 215, 145, 147, 235, 27, 203, 174, 18, 114, 18, 232, 10, 115, 94, 252, 228, 204, 53, 197, 215, 194, 95, 40, 10, 91, 29, 8, 61, 84, 244, 52, 228, 189, 215, 232, 229, 199, 106, 119, 188, 71, 18, 179, 3, 111, 184, 29, 2, 200, 121, 177, 193, 186, 63, 58, 39, 189, 148, 208, 248, 46, 23, 143, 6, 164, 77, 247, 185, 73, 244, 53, 226, 10, 89, 242, 191, 172, 61, 125, 142, 171, 232, 244, 109, 35, 103, 96, 100, 99, 63, 45, 237, 145, 95, 197, 197, 48, 200, 118, 138, 124, 152, 72, 143, 163, 149, 183, 150, 153, 49, 234, 245, 157, 135, 3, 145, 97, 215, 54, 49, 87, 76, 54, 235, 88, 146, 205, 53, 252, 94, 49, 189, 203, 250, 158, 88, 96, 122, 113, 160, 113, 181, 85, 0, 10, 10, 188, 28, 112, 224, 22, 43, 216, 17, 87, 101, 42, 28, 26, 177, 5, 40, 36, 66, 45, 28, 255, 32, 99, 243, 99, 249, 192, 242, 52, 165, 239, 215, 98, 108, 174, 236, 249, 45, 169, 153, 208, 109, 17, 89, 151, 52, 188, 58, 17, 160, 58, 11, 241, 149, 87, 192, 117, 57, 42, 160, 160, 4, 83, 236, 110, 87, 191, 143, 64, 140, 46, 48, 225, 145, 73, 189, 126, 26, 235, 167, 191, 225, 106, 43, 39, 148, 11, 74, 61, 80, 237, 149, 180, 81, 27, 23, 198, 133, 26, 40, 62, 70, 39, 174, 205, 42, 210, 149, 161, 49, 141, 52, 217, 216, 103, 10, 133, 254, 124, 153, 209, 77, 156, 206, 37, 186, 245, 228, 242, 3, 78, 252, 89, 203, 38, 57, 132, 108, 224, 51, 44, 53, 172, 142, 85, 23, 38, 97, 112, 156, 98, 241, 234, 61, 248, 209, 220, 192, 105, 31, 226, 242, 170, 176, 255, 233, 37, 208, 177, 238, 61, 95, 147, 75, 144, 108, 182, 35, 56, 146, 116, 228, 176, 108, 243, 93, 3, 204, 39, 89, 17, 25, 37, 81, 255, 247, 113, 220, 158, 29, 130, 137, 251, 25, 186, 187, 172, 185, 220, 185, 87, 36, 25, 13, 3, 11, 98, 197, 166, 167, 168, 66, 19, 218, 18, 224, 67, 185, 255, 176, 180, 55, 179, 96, 183, 50, 23, 206, 67, 216, 154, 66, 21, 179, 165, 135, 56, 23, 53, 185, 60, 222, 24, 126, 24, 87, 17, 168, 193, 172, 99, 254, 105, 12, 11, 19, 184, 160, 108, 148, 91, 132, 247, 201, 7, 50, 37, 237, 157, 31, 42, 26, 2, 80, 81, 207, 138, 248, 79, 105, 41, 215, 245, 23, 214, 131, 70, 71, 241, 252, 30, 162, 70, 29, 205, 26, 14, 199, 227, 208, 3, 24, 111, 192, 187, 191, 123, 74, 96, 19, 114, 253, 29, 66, 7, 42, 138, 142, 28, 172, 114, 73, 39, 86, 99, 146, 118, 35, 29, 34, 75, 27, 36, 44, 165, 188, 17, 71, 159, 228, 219, 8, 217, 223, 68, 234, 127, 79, 214, 135, 178, 47, 103, 46, 17, 164, 6, 190, 50, 52, 26, 208, 33, 167, 141, 172, 87, 103, 50, 251, 2, 109, 198, 118, 112, 94, 80, 126, 160, 57, 228, 138, 62, 51, 144, 95, 101, 18, 81, 115, 52, 175, 207, 43, 0, 69, 169, 222, 89, 235, 17, 28, 121, 113, 207, 204, 177, 130, 238, 199, 211, 196, 114, 0, 0, 0, 6, 107, 91, 55, 173, 215, 77, 11, 83, 178, 187, 76, 188, 250, 49, 139, 239, 19, 150, 124, 94, 80, 215, 186, 179, 0, 247, 255, 51, 219, 31, 97, 242, 25, 151, 161, 193, 165, 155, 2, 124, 50, 43, 62, 37, 254, 245, 103, 232, 216, 7, 191, 238, 4, 247, 206, 181, 189, 39, 95, 252, 133, 198, 68, 189, 238, 88, 94, 48, 12, 21, 1, 54, 35, 109, 160, 196, 129, 34, 162, 61, 17, 242, 50, 161, 5, 232, 243, 85, 185, 4, 150, 202, 194, 63, 197, 254, 245, 41, 178, 96, 52, 255, 63, 36, 85, 36, 126, 142, 2, 3, 7, 2, 164, 28, 202, 141, 86, 27, 242, 241, 235, 118, 7, 14, 34, 74, 123, 62, 9, 67, 224, 125, 246, 223, 11, 48, 91, 163, 59, 253, 116, 114, 40, 77, 213, 8, 134, 74, 230, 225, 62, 121, 129, 80, 244, 161, 201, 186, 221, 203, 118, 231, 115, 165, 116, 54, 174, 215, 119, 70, 42, 127, 220, 206, 6, 206, 144, 0, 105, 38, 71, 127, 62, 243, 219, 246, 237, 131, 98, 18, 44, 71, 63, 102, 251, 59, 54, 235, 23, 208, 246, 154, 197, 128, 1, 158, 142, 139, 213, 244, 28, 26, 105, 23, 46, 250, 127, 125, 74, 148, 35, 37, 196, 252, 75, 166, 118, 7, 15, 19, 133, 49, 201, 125, 223, 126, 70, 17, 4, 206, 17, 229, 215, 4, 186, 135, 149, 8, 251, 22, 240, 18, 206, 235, 205, 146, 41, 223, 135, 200, 184, 134, 163, 107, 113, 247, 119, 179, 216, 93, 59, 149, 236, 138, 90, 181, 3, 209, 194, 75, 191, 115, 221, 109, 31, 192, 46, 50, 199, 95, 184, 254, 136, 221, 114, 84, 98, 253, 130, 184, 47, 62, 90, 186, 138, 197, 116, 226, 245, 35, 126, 240, 248, 138, 232, 166, 222, 251, 184, 237]},
	];
	for t in TESTS {
        let (head, thing2, _tail): (&[u8], &[LmsSignature<8, 34, 10>], &[u8]) =
            unsafe { t.signature.align_to::<LmsSignature<8, 34, 10>>() };

        assert!(head.is_empty());
        let lms_sig = thing2[0];
        let verify_result = Lms::default().verify_lms_signature_generic(
            &mut sha256,
            &MESSAGE,
            &lms_public_key,
            &lms_sig,
        );
        if t.test_passed {
            // if the test is supposed to pass then we better have no errors and a successful verification
            let result = verify_result.unwrap();
            assert_eq!(result, LmsResult::Success)
        } else {
            // if the test is supposed to fail it could be for a number of reasons that could raise a variety of errors
            // if the verification didn't error, then extract the LMS result and ensure it is a failed verification
            if verify_result.is_ok() {
                let result = verify_result.unwrap();
                assert_eq!(result, LmsResult::SigVerifyFailed)
            }
        }
    }
}

test_suite! {
    test_lms_random_suite,
}
