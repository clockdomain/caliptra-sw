/*++

Licensed under the Apache-2.0 license.

Abstract:

    File contains test cases for LMS signature verification. This file is machine generated.

--*/

#![no_std]
#![no_main]

use caliptra_drivers::{Lms, LmsResult, Sha256};
use caliptra_lms_types::{LmsPublicKey, LmsSignature};
use caliptra_registers::sha256::Sha256Reg;
use caliptra_test_harness::test_suite;

struct LmsTest<'a> {
    test_passed: bool,
    signature: &'a [u8],
}

fn test_lms_random_suite() {
    let mut sha256 = unsafe { Sha256::new(Sha256Reg::new()) };
    	const MESSAGE :[u8; 33] = [116, 104, 105, 115, 32, 105, 115, 32, 116, 104, 101, 32, 109, 101, 115, 115, 97, 103, 101, 32, 73, 32, 119, 97, 110, 116, 32, 115, 105, 103, 110, 101, 100];
	const PUBLIC_KEY_BYTES: [u8; 48] = [0, 0, 0, 11, 0, 0, 0, 7, 56, 175, 127, 68, 185, 89, 202, 158, 152, 101, 27, 56, 52, 188, 81, 60, 88, 124, 41, 147, 57, 200, 68, 112, 166, 14, 86, 144, 253, 150, 194, 227, 224, 179, 175, 1, 9, 30, 160, 10];
	let (head, thing1, _tail): (&[u8], &[LmsPublicKey<6>], &[u8]) = unsafe { PUBLIC_KEY_BYTES.align_to::<LmsPublicKey<6>>() };
    	assert!(head.is_empty());
    	let lms_public_key = thing1[0];
	const TESTS: [LmsTest; 2] = [
		LmsTest{ test_passed: true, signature: &[0, 0, 1, 174, 0, 0, 0, 7, 233, 222, 45, 27, 237, 154, 173, 198, 13, 85, 190, 110, 6, 9, 210, 231, 15, 120, 35, 78, 209, 255, 203, 41, 76, 149, 81, 229, 95, 68, 105, 103, 240, 105, 229, 134, 55, 148, 122, 254, 44, 252, 108, 130, 225, 231, 121, 111, 179, 160, 92, 76, 16, 146, 121, 86, 17, 101, 224, 11, 188, 35, 133, 64, 132, 67, 225, 167, 75, 184, 246, 226, 18, 183, 31, 154, 93, 53, 128, 29, 187, 175, 73, 141, 26, 168, 91, 33, 72, 198, 192, 36, 78, 237, 167, 203, 247, 248, 89, 44, 112, 103, 57, 47, 161, 122, 135, 1, 25, 196, 197, 147, 62, 155, 212, 222, 246, 46, 247, 78, 194, 157, 19, 247, 201, 222, 10, 47, 2, 232, 67, 183, 75, 46, 163, 180, 232, 111, 220, 22, 44, 4, 155, 44, 228, 209, 71, 89, 123, 4, 33, 78, 190, 15, 93, 208, 235, 14, 141, 224, 145, 81, 224, 112, 161, 219, 55, 210, 187, 180, 50, 188, 137, 15, 132, 241, 124, 98, 229, 186, 198, 34, 3, 214, 111, 213, 201, 9, 235, 217, 253, 48, 110, 163, 231, 100, 208, 59, 166, 120, 200, 46, 199, 213, 243, 38, 47, 243, 0, 121, 197, 131, 13, 199, 182, 157, 58, 19, 232, 21, 8, 46, 239, 206, 77, 236, 193, 47, 74, 70, 255, 205, 190, 65, 70, 144, 196, 142, 200, 206, 230, 139, 85, 134, 192, 49, 205, 157, 179, 229, 17, 165, 173, 147, 23, 178, 239, 183, 54, 120, 29, 74, 130, 165, 204, 170, 107, 59, 61, 177, 81, 173, 139, 111, 206, 203, 68, 62, 116, 92, 152, 53, 241, 197, 205, 128, 32, 238, 219, 190, 140, 32, 78, 118, 182, 70, 139, 198, 121, 11, 190, 228, 106, 40, 234, 88, 155, 186, 104, 135, 92, 96, 7, 164, 120, 117, 145, 226, 99, 175, 59, 217, 192, 36, 86, 138, 57, 251, 197, 120, 221, 219, 239, 87, 149, 226, 245, 245, 81, 188, 124, 116, 229, 92, 59, 99, 243, 210, 13, 211, 9, 233, 134, 72, 155, 139, 12, 158, 254, 249, 1, 70, 227, 101, 53, 208, 233, 106, 70, 29, 120, 124, 232, 253, 150, 1, 154, 125, 33, 40, 152, 43, 79, 82, 233, 49, 11, 197, 165, 68, 194, 98, 27, 159, 42, 69, 247, 224, 92, 226, 208, 124, 0, 161, 9, 143, 76, 164, 138, 91, 133, 69, 84, 129, 227, 223, 2, 250, 126, 34, 2, 216, 133, 208, 230, 51, 161, 238, 80, 202, 106, 233, 131, 199, 178, 236, 204, 106, 216, 215, 88, 206, 255, 52, 145, 120, 187, 205, 131, 65, 56, 197, 205, 89, 36, 84, 133, 191, 131, 160, 54, 162, 173, 1, 216, 18, 242, 119, 58, 146, 27, 63, 133, 42, 7, 34, 163, 5, 149, 74, 162, 118, 5, 182, 180, 177, 218, 3, 171, 57, 116, 225, 237, 231, 218, 41, 32, 135, 8, 79, 225, 181, 197, 92, 129, 137, 31, 138, 142, 173, 3, 13, 212, 5, 57, 93, 83, 16, 197, 43, 88, 32, 105, 231, 247, 67, 149, 184, 11, 181, 240, 219, 43, 114, 157, 47, 190, 137, 163, 26, 65, 134, 12, 10, 239, 85, 77, 254, 108, 194, 183, 9, 165, 213, 197, 176, 250, 89, 254, 103, 92, 113, 41, 199, 42, 22, 140, 100, 103, 135, 221, 102, 9, 216, 124, 215, 74, 79, 144, 180, 181, 47, 135, 156, 216, 88, 124, 30, 232, 173, 28, 97, 42, 99, 4, 59, 181, 220, 158, 23, 21, 82, 83, 128, 8, 37, 92, 51, 227, 79, 122, 185, 144, 49, 114, 78, 227, 132, 25, 131, 99, 170, 217, 58, 66, 164, 21, 155, 236, 102, 204, 223, 191, 1, 21, 122, 251, 64, 189, 248, 41, 196, 127, 71, 90, 83, 235, 232, 242, 200, 101, 193, 242, 19, 114, 5, 102, 10, 191, 220, 222, 22, 135, 86, 117, 145, 72, 50, 217, 7, 39, 142, 247, 49, 44, 216, 69, 140, 141, 40, 242, 13, 194, 155, 184, 8, 33, 250, 157, 183, 251, 80, 103, 130, 248, 89, 193, 236, 180, 213, 140, 91, 128, 213, 252, 36, 46, 170, 123, 52, 139, 220, 61, 201, 103, 55, 7, 207, 58, 207, 120, 194, 129, 244, 217, 250, 205, 91, 10, 225, 231, 181, 249, 244, 31, 125, 63, 102, 36, 140, 160, 218, 148, 178, 157, 254, 188, 34, 93, 25, 65, 108, 145, 179, 23, 199, 91, 96, 118, 32, 63, 223, 226, 85, 108, 162, 123, 90, 65, 48, 75, 10, 37, 248, 180, 8, 2, 158, 230, 65, 45, 54, 86, 120, 78, 174, 163, 106, 25, 179, 207, 194, 198, 29, 170, 180, 51, 228, 119, 27, 192, 157, 137, 119, 234, 179, 252, 66, 19, 38, 247, 108, 151, 16, 205, 63, 110, 235, 228, 188, 107, 155, 76, 38, 83, 13, 99, 61, 108, 137, 21, 255, 190, 72, 96, 196, 190, 199, 53, 86, 69, 95, 205, 172, 15, 252, 172, 204, 203, 148, 59, 253, 119, 188, 161, 161, 101, 237, 112, 236, 209, 255, 245, 56, 230, 65, 254, 155, 16, 92, 78, 83, 176, 111, 191, 110, 22, 188, 185, 53, 229, 234, 196, 47, 2, 27, 62, 161, 183, 117, 107, 135, 213, 153, 234, 53, 40, 242, 126, 177, 190, 230, 71, 240, 227, 148, 176, 252, 183, 168, 133, 174, 0, 227, 115, 164, 182, 52, 253, 34, 156, 66, 46, 156, 67, 80, 86, 45, 18, 61, 98, 215, 67, 183, 102, 137, 168, 253, 47, 208, 16, 13, 5, 98, 130, 92, 98, 87, 50, 96, 146, 50, 141, 241, 81, 36, 176, 226, 240, 181, 168, 240, 255, 246, 93, 226, 78, 200, 178, 250, 47, 157, 98, 83, 197, 168, 236, 12, 251, 44, 136, 99, 138, 140, 24, 62, 145, 228, 56, 115, 202, 251, 151, 38, 212, 212, 62, 236, 11, 77, 4, 194, 208, 100, 95, 21, 79, 89, 126, 127, 130, 138, 146, 252, 111, 89, 113, 250, 112, 201, 157, 61, 224, 218, 183, 104, 247, 242, 79, 83, 12, 232, 210, 54, 159, 39, 115, 25, 22, 69, 231, 86, 73, 100, 31, 192, 88, 103, 23, 101, 172, 215, 20, 253, 40, 171, 96, 95, 76, 95, 47, 11, 88, 51, 3, 146, 75, 38, 46, 56, 216, 52, 105, 75, 11, 184, 155, 193, 230, 187, 164, 166, 60, 79, 6, 246, 75, 119, 193, 56, 118, 168, 158, 126, 64, 250, 199, 9, 93, 5, 35, 177, 223, 31, 115, 80, 251, 131, 133, 212, 172, 110, 169, 248, 164, 0, 203, 240, 152, 167, 193, 126, 187, 142, 177, 182, 206, 217, 33, 140, 100, 151, 193, 9, 102, 204, 204, 21, 164, 202, 209, 156, 170, 206, 16, 146, 8, 246, 27, 197, 78, 164, 233, 218, 105, 194, 104, 236, 210, 93, 91, 5, 195, 148, 22, 156, 50, 254, 80, 23, 199, 74, 79, 97, 205, 105, 98, 155, 14, 51, 80, 161, 102, 108, 181, 111, 205, 129, 75, 183, 157, 196, 208, 208, 31, 155, 94, 240, 71, 153, 204, 78, 4, 227, 65, 133, 120, 135, 148, 81, 27, 171, 1, 124, 59, 10, 6, 165, 219, 46, 67, 41, 176, 17, 110, 157, 200, 185, 160, 243, 128, 153, 65, 62, 109, 188, 74, 23, 224, 179, 127, 190, 101, 113, 252, 28, 193, 53, 0, 0, 0, 11, 130, 221, 176, 105, 35, 223, 228, 200, 16, 66, 182, 126, 103, 107, 171, 57, 104, 3, 12, 209, 255, 102, 204, 219, 95, 184, 182, 188, 38, 133, 47, 189, 140, 106, 16, 128, 245, 96, 196, 108, 0, 8, 44, 111, 26, 9, 106, 163, 137, 226, 234, 246, 49, 103, 243, 46, 34, 7, 228, 187, 67, 108, 198, 83, 63, 65, 39, 128, 248, 134, 114, 198, 142, 96, 159, 232, 94, 57, 89, 120, 81, 102, 133, 208, 233, 180, 92, 143, 121, 53, 175, 11, 232, 114, 100, 202, 142, 85, 209, 221, 131, 132, 197, 107, 181, 144, 153, 65, 30, 235, 215, 54, 143, 25, 253, 230, 21, 34, 234, 4, 90, 189, 111, 75, 130, 168, 74, 126, 193, 32, 217, 251, 233, 147, 127, 113, 213, 14, 240, 231, 238, 112, 195, 207, 57, 178, 235, 19, 173, 91, 249, 162, 174, 48, 107, 79, 87, 19, 26, 253, 120, 30, 95, 20, 70, 16, 89, 248, 129, 169, 210, 242, 46, 105, 18, 119, 164, 162, 65, 130, 213, 151, 83, 57, 188, 208, 140, 238, 128, 116, 34, 155, 102, 220, 232, 64, 58, 187, 144, 146, 1, 78, 137, 246, 241, 98, 51, 103, 237, 83, 89, 213, 60, 137, 154, 41, 183, 195, 143, 40, 144, 121, 47, 241, 254, 196, 163, 207, 209, 7, 2, 63, 108, 251, 112, 186, 40, 173, 25, 225]},
		LmsTest{ test_passed: true, signature: &[0, 0, 1, 122, 0, 0, 0, 7, 2, 67, 29, 159, 245, 255, 189, 234, 103, 106, 178, 126, 86, 50, 109, 102, 244, 89, 95, 251, 156, 131, 33, 166, 99, 66, 223, 157, 148, 96, 158, 245, 34, 91, 114, 66, 192, 2, 56, 64, 86, 124, 237, 206, 165, 38, 253, 75, 7, 122, 184, 12, 133, 241, 21, 236, 192, 9, 194, 0, 115, 69, 122, 55, 105, 157, 39, 225, 224, 131, 5, 254, 232, 191, 19, 94, 184, 240, 201, 128, 182, 10, 207, 83, 197, 190, 144, 151, 188, 232, 63, 32, 247, 142, 0, 154, 116, 138, 149, 139, 93, 104, 17, 140, 149, 244, 117, 210, 94, 199, 201, 214, 90, 181, 105, 133, 5, 85, 141, 100, 76, 19, 97, 27, 81, 234, 8, 230, 6, 78, 145, 235, 250, 243, 54, 179, 6, 149, 153, 60, 26, 239, 45, 174, 98, 172, 199, 54, 113, 28, 68, 196, 112, 255, 237, 118, 139, 206, 97, 214, 76, 178, 226, 253, 153, 117, 94, 216, 156, 194, 99, 106, 54, 166, 50, 112, 33, 252, 233, 214, 186, 30, 178, 152, 27, 28, 254, 102, 201, 52, 19, 196, 190, 82, 121, 78, 228, 217, 14, 226, 97, 14, 242, 249, 180, 64, 10, 28, 194, 180, 194, 40, 0, 247, 163, 21, 18, 164, 46, 23, 154, 8, 74, 69, 221, 24, 93, 54, 86, 171, 178, 162, 89, 192, 98, 229, 203, 6, 5, 70, 132, 73, 48, 164, 119, 165, 26, 158, 103, 202, 108, 183, 87, 102, 131, 79, 244, 50, 53, 184, 84, 216, 104, 234, 79, 100, 39, 89, 145, 109, 158, 184, 22, 3, 56, 125, 3, 223, 151, 161, 23, 155, 89, 190, 162, 66, 16, 32, 100, 57, 175, 146, 180, 135, 21, 106, 92, 231, 252, 241, 122, 48, 7, 58, 194, 225, 31, 158, 34, 127, 147, 11, 31, 16, 7, 190, 81, 157, 50, 97, 70, 131, 147, 167, 169, 215, 22, 105, 199, 77, 189, 253, 18, 243, 144, 186, 177, 151, 242, 7, 52, 20, 188, 45, 172, 44, 43, 246, 17, 7, 59, 165, 151, 62, 245, 95, 39, 144, 208, 61, 77, 164, 128, 150, 59, 217, 202, 23, 5, 185, 191, 118, 145, 217, 127, 191, 186, 197, 218, 9, 186, 186, 214, 102, 40, 163, 173, 166, 111, 137, 218, 143, 33, 116, 80, 198, 61, 128, 129, 6, 3, 67, 93, 241, 238, 82, 5, 96, 76, 139, 53, 204, 22, 126, 255, 156, 0, 24, 118, 142, 76, 80, 107, 249, 39, 6, 7, 91, 8, 197, 82, 47, 217, 173, 122, 246, 218, 168, 26, 77, 217, 118, 72, 211, 212, 153, 191, 85, 226, 110, 246, 240, 189, 2, 22, 164, 85, 214, 250, 112, 187, 89, 24, 70, 6, 101, 207, 198, 152, 93, 182, 88, 124, 174, 251, 183, 231, 132, 124, 205, 48, 80, 143, 236, 221, 203, 59, 237, 46, 168, 73, 31, 120, 86, 208, 51, 203, 111, 32, 240, 243, 80, 134, 100, 127, 170, 170, 137, 201, 4, 141, 207, 255, 225, 184, 155, 143, 24, 252, 252, 126, 0, 233, 69, 141, 24, 30, 100, 196, 187, 169, 59, 64, 101, 70, 86, 56, 247, 159, 162, 144, 8, 162, 56, 51, 110, 242, 227, 195, 115, 186, 250, 150, 241, 45, 105, 102, 202, 28, 119, 29, 93, 8, 191, 79, 181, 105, 109, 198, 0, 4, 198, 93, 62, 158, 61, 90, 16, 67, 151, 210, 217, 16, 23, 250, 60, 160, 59, 195, 160, 202, 15, 71, 196, 90, 168, 56, 229, 45, 152, 177, 19, 217, 53, 45, 188, 10, 192, 122, 229, 3, 152, 191, 182, 195, 77, 111, 88, 150, 212, 144, 54, 133, 151, 72, 235, 43, 78, 89, 165, 231, 173, 135, 179, 236, 104, 44, 179, 119, 114, 185, 250, 147, 67, 240, 110, 206, 215, 18, 53, 195, 255, 214, 83, 174, 253, 172, 123, 117, 253, 195, 75, 104, 4, 172, 67, 100, 95, 104, 54, 211, 209, 85, 181, 123, 188, 245, 231, 43, 20, 47, 198, 237, 11, 76, 172, 92, 34, 8, 76, 25, 124, 50, 75, 107, 20, 78, 121, 139, 14, 219, 178, 208, 142, 128, 125, 62, 215, 255, 11, 240, 198, 53, 26, 232, 132, 145, 251, 46, 95, 147, 116, 76, 185, 159, 237, 2, 126, 29, 76, 46, 16, 191, 157, 70, 131, 167, 98, 226, 83, 249, 156, 205, 92, 111, 168, 133, 42, 88, 61, 45, 4, 59, 29, 86, 61, 10, 99, 52, 119, 45, 61, 29, 186, 233, 143, 86, 99, 226, 16, 177, 212, 192, 248, 213, 51, 133, 143, 26, 153, 113, 225, 75, 154, 56, 217, 166, 183, 105, 87, 77, 141, 58, 255, 222, 210, 103, 93, 212, 182, 43, 140, 115, 247, 100, 216, 82, 70, 93, 61, 167, 90, 249, 2, 130, 208, 51, 98, 127, 87, 70, 131, 201, 48, 41, 179, 100, 69, 205, 239, 177, 252, 86, 62, 147, 99, 137, 72, 232, 55, 95, 78, 156, 63, 10, 101, 251, 189, 191, 221, 103, 153, 9, 39, 36, 251, 187, 164, 105, 42, 4, 187, 72, 105, 215, 215, 47, 58, 104, 184, 121, 79, 247, 81, 189, 145, 41, 114, 172, 161, 178, 156, 161, 3, 245, 116, 73, 126, 140, 149, 63, 67, 87, 214, 44, 196, 212, 139, 75, 200, 30, 208, 246, 240, 139, 158, 23, 25, 56, 52, 5, 137, 40, 157, 103, 152, 68, 129, 235, 52, 145, 175, 103, 123, 92, 69, 136, 154, 71, 138, 69, 84, 117, 166, 68, 38, 127, 209, 238, 68, 93, 121, 45, 212, 213, 253, 171, 242, 12, 250, 208, 89, 9, 192, 56, 224, 76, 177, 151, 129, 176, 52, 50, 83, 243, 136, 140, 181, 82, 16, 19, 200, 189, 156, 94, 190, 245, 118, 36, 114, 11, 30, 39, 33, 58, 156, 13, 153, 252, 109, 52, 193, 54, 102, 229, 130, 178, 218, 27, 189, 139, 122, 142, 156, 111, 20, 165, 126, 237, 219, 52, 49, 141, 241, 189, 112, 236, 35, 64, 240, 254, 137, 42, 224, 130, 187, 22, 225, 244, 239, 42, 213, 131, 225, 89, 242, 75, 168, 176, 159, 52, 208, 165, 123, 80, 96, 236, 193, 221, 17, 74, 54, 33, 28, 111, 218, 62, 112, 117, 248, 102, 38, 185, 241, 229, 124, 119, 182, 174, 142, 81, 199, 204, 118, 203, 123, 53, 185, 231, 193, 23, 80, 216, 176, 52, 182, 167, 228, 125, 235, 63, 126, 178, 75, 119, 203, 35, 169, 123, 207, 95, 36, 239, 61, 243, 200, 173, 145, 25, 200, 219, 159, 132, 60, 3, 147, 201, 37, 254, 118, 19, 131, 19, 73, 4, 148, 0, 46, 164, 79, 214, 74, 38, 211, 118, 76, 228, 102, 81, 224, 180, 3, 10, 228, 1, 0, 251, 59, 229, 33, 130, 192, 194, 243, 191, 106, 11, 86, 179, 234, 115, 56, 71, 239, 60, 33, 250, 25, 22, 181, 98, 114, 133, 22, 79, 233, 186, 21, 26, 247, 30, 111, 221, 134, 239, 72, 70, 3, 64, 209, 4, 97, 65, 185, 252, 95, 223, 94, 55, 184, 2, 235, 66, 112, 134, 177, 83, 181, 143, 98, 253, 29, 12, 201, 33, 158, 117, 246, 80, 217, 117, 67, 25, 198, 141, 232, 104, 47, 174, 139, 213, 169, 22, 83, 117, 4, 88, 202, 56, 178, 18, 218, 86, 63, 124, 21, 243, 191, 0, 0, 0, 11, 191, 220, 78, 19, 50, 8, 78, 178, 130, 161, 218, 166, 253, 223, 83, 87, 93, 44, 249, 130, 141, 28, 201, 189, 64, 29, 146, 226, 133, 249, 180, 240, 34, 188, 184, 42, 37, 111, 254, 0, 3, 253, 12, 128, 249, 156, 145, 235, 245, 187, 74, 43, 227, 254, 250, 228, 200, 103, 123, 126, 178, 101, 143, 151, 195, 168, 170, 98, 2, 131, 2, 237, 199, 46, 42, 221, 91, 104, 66, 120, 156, 136, 167, 112, 74, 52, 32, 99, 187, 232, 93, 141, 7, 168, 232, 217, 169, 7, 148, 11, 103, 28, 92, 233, 111, 12, 245, 29, 5, 20, 138, 116, 221, 196, 55, 30, 172, 142, 128, 28, 24, 242, 73, 186, 2, 111, 179, 151, 123, 196, 157, 182, 228, 179, 182, 155, 204, 77, 41, 244, 66, 144, 179, 212, 92, 233, 81, 197, 212, 19, 126, 240, 255, 204, 48, 42, 138, 138, 58, 47, 96, 25, 106, 9, 180, 222, 18, 255, 63, 93, 158, 252, 209, 188, 168, 6, 190, 46, 174, 47, 63, 124, 14, 94, 143, 84, 13, 74, 92, 93, 216, 213, 102, 220, 232, 64, 58, 187, 144, 146, 1, 78, 137, 246, 241, 98, 51, 103, 237, 83, 89, 213, 60, 137, 154, 41, 183, 195, 143, 40, 144, 121, 47, 241, 254, 196, 163, 207, 209, 7, 2, 63, 108, 251, 112, 186, 40, 173, 25, 225]},
	];
	for t in TESTS {
        let (head, thing2, _tail): (&[u8], &[LmsSignature<6, 51, 10>], &[u8]) =
            unsafe { t.signature.align_to::<LmsSignature<6, 51, 10>>() };

        assert!(head.is_empty());
        let lms_sig = thing2[0];
        let verify_result = Lms::default().verify_lms_signature_generic(
            &mut sha256,
            &MESSAGE,
            &lms_public_key,
            &lms_sig,
        );
        if t.test_passed {
            // if the test is supposed to pass then we better have no errors and a successful verification
            let result = verify_result.unwrap();
            assert_eq!(result, LmsResult::Success)
        } else {
            // if the test is supposed to fail it could be for a number of reasons that could raise a variety of errors
            // if the verification didn't error, then extract the LMS result and ensure it is a failed verification
            if verify_result.is_ok() {
                let result = verify_result.unwrap();
                assert_eq!(result, LmsResult::SigVerifyFailed)
            }
        }
    }
}

test_suite! {
    test_lms_random_suite,
}
