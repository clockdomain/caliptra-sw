/*++

Licensed under the Apache-2.0 license.

Abstract:

    File contains test cases for LMS signature verification. This file is machine generated.

--*/

#![no_std]
#![no_main]

use caliptra_drivers::{Lms, LmsResult, Sha256};
use caliptra_lms_types::{LmsPublicKey, LmsSignature};
use caliptra_registers::sha256::Sha256Reg;
use caliptra_test_harness::test_suite;

struct LmsTest<'a> {
    test_passed: bool,
    signature: &'a [u8],
}

fn test_lms_random_suite() {
    let mut sha256 = unsafe { Sha256::new(Sha256Reg::new()) };
    	const MESSAGE :[u8; 33] = [116, 104, 105, 115, 32, 105, 115, 32, 116, 104, 101, 32, 109, 101, 115, 115, 97, 103, 101, 32, 73, 32, 119, 97, 110, 116, 32, 115, 105, 103, 110, 101, 100];
	const PUBLIC_KEY_BYTES: [u8; 56] = [0, 0, 0, 5, 0, 0, 0, 4, 202, 46, 250, 117, 135, 33, 98, 78, 41, 173, 172, 30, 142, 41, 2, 31, 16, 61, 224, 131, 243, 228, 130, 126, 148, 55, 164, 34, 111, 99, 158, 28, 158, 178, 113, 107, 187, 235, 16, 39, 34, 94, 213, 248, 38, 51, 164, 34];
	let (head, thing1, _tail): (&[u8], &[LmsPublicKey<8>], &[u8]) = unsafe { PUBLIC_KEY_BYTES.align_to::<LmsPublicKey<8>>() };
    	assert!(head.is_empty());
    	let lms_public_key = thing1[0];
	const TESTS: [LmsTest; 2] = [
		LmsTest{ test_passed: true, signature: &[0, 0, 0, 14, 0, 0, 0, 4, 131, 136, 222, 117, 70, 186, 77, 121, 76, 77, 109, 70, 51, 252, 88, 116, 64, 189, 46, 8, 195, 122, 95, 0, 139, 79, 30, 180, 131, 247, 216, 5, 96, 248, 153, 228, 68, 57, 227, 154, 62, 86, 242, 89, 177, 250, 134, 58, 4, 14, 79, 132, 181, 19, 240, 11, 68, 160, 192, 122, 195, 149, 167, 24, 217, 100, 229, 244, 135, 109, 104, 70, 160, 15, 132, 175, 15, 159, 37, 46, 89, 159, 246, 93, 117, 220, 218, 168, 25, 162, 21, 68, 78, 64, 250, 193, 37, 195, 131, 23, 250, 66, 131, 15, 225, 50, 105, 5, 27, 211, 59, 220, 107, 220, 98, 118, 185, 155, 224, 28, 33, 152, 208, 45, 230, 35, 98, 231, 161, 41, 87, 29, 139, 112, 248, 245, 96, 81, 10, 52, 208, 249, 19, 214, 211, 211, 102, 115, 235, 230, 243, 80, 104, 201, 109, 181, 81, 187, 242, 38, 65, 246, 58, 37, 230, 12, 80, 71, 76, 10, 0, 63, 98, 71, 51, 89, 102, 101, 187, 44, 157, 67, 181, 132, 7, 62, 146, 120, 158, 97, 143, 227, 216, 86, 140, 2, 153, 237, 163, 23, 186, 88, 254, 172, 9, 0, 63, 45, 11, 133, 44, 6, 210, 191, 38, 2, 244, 3, 150, 127, 240, 146, 49, 91, 228, 215, 191, 94, 194, 96, 90, 182, 88, 242, 125, 158, 103, 169, 57, 44, 47, 249, 184, 102, 174, 58, 63, 68, 243, 129, 206, 108, 173, 140, 49, 73, 160, 140, 224, 101, 236, 24, 63, 158, 7, 229, 102, 51, 7, 52, 193, 26, 233, 244, 213, 153, 164, 90, 15, 176, 109, 144, 130, 134, 111, 120, 31, 214, 112, 55, 64, 83, 115, 144, 105, 52, 63, 216, 227, 80, 174, 110, 190, 169, 123, 106, 68, 243, 82, 211, 229, 55, 39, 60, 14, 31, 110, 108, 47, 177, 207, 59, 110, 212, 185, 184, 154, 45, 166, 0, 162, 136, 47, 34, 227, 137, 152, 104, 141, 207, 222, 108, 149, 41, 161, 145, 201, 211, 69, 230, 8, 36, 20, 202, 138, 122, 38, 65, 68, 222, 243, 152, 181, 4, 29, 28, 138, 159, 145, 80, 16, 232, 18, 45, 152, 20, 246, 96, 111, 79, 205, 245, 140, 22, 57, 136, 104, 190, 111, 178, 196, 74, 243, 141, 122, 10, 41, 59, 69, 218, 194, 30, 235, 166, 129, 189, 12, 36, 138, 147, 161, 184, 240, 73, 5, 196, 169, 69, 18, 31, 58, 168, 156, 68, 21, 236, 222, 43, 132, 91, 59, 94, 26, 10, 194, 223, 158, 11, 97, 175, 133, 102, 84, 164, 207, 195, 217, 72, 164, 21, 239, 213, 5, 22, 135, 191, 246, 132, 214, 151, 128, 53, 148, 21, 239, 47, 116, 230, 232, 107, 18, 32, 138, 19, 39, 97, 174, 69, 35, 121, 174, 254, 45, 213, 22, 184, 19, 129, 245, 83, 157, 135, 39, 193, 33, 113, 91, 81, 152, 147, 205, 15, 156, 183, 181, 145, 42, 165, 243, 188, 16, 27, 252, 166, 65, 86, 63, 134, 144, 232, 81, 249, 167, 245, 82, 58, 4, 151, 242, 90, 176, 93, 208, 70, 215, 231, 197, 177, 141, 216, 106, 229, 231, 234, 255, 16, 232, 95, 70, 124, 46, 247, 203, 217, 79, 74, 251, 4, 174, 194, 71, 13, 12, 118, 107, 154, 87, 45, 88, 216, 243, 152, 89, 184, 177, 231, 129, 141, 121, 152, 17, 65, 33, 164, 50, 74, 191, 174, 140, 106, 86, 103, 147, 75, 140, 130, 124, 157, 246, 236, 27, 12, 155, 249, 190, 110, 127, 195, 19, 49, 177, 170, 246, 55, 46, 115, 110, 40, 189, 163, 25, 125, 112, 82, 173, 149, 118, 201, 196, 251, 31, 230, 93, 210, 124, 102, 112, 201, 92, 165, 36, 57, 88, 179, 0, 193, 12, 211, 186, 239, 101, 126, 11, 75, 175, 147, 85, 27, 89, 200, 90, 230, 13, 173, 22, 252, 226, 32, 105, 198, 9, 184, 200, 81, 192, 89, 92, 9, 131, 227, 237, 242, 138, 242, 247, 41, 31, 94, 217, 142, 61, 220, 227, 64, 127, 224, 160, 161, 176, 93, 43, 223, 128, 189, 253, 76, 241, 18, 42, 125, 32, 171, 154, 94, 32, 246, 132, 53, 195, 162, 95, 151, 149, 55, 114, 25, 230, 65, 21, 159, 193, 222, 238, 103, 123, 94, 33, 70, 67, 37, 19, 94, 73, 213, 247, 41, 24, 117, 174, 22, 114, 254, 166, 226, 77, 243, 79, 214, 227, 129, 176, 59, 145, 75, 226, 27, 250, 200, 207, 196, 22, 203, 219, 70, 190, 96, 81, 163, 242, 242, 236, 249, 58, 17, 173, 21, 10, 79, 40, 187, 178, 211, 242, 91, 30, 125, 133, 100, 190, 151, 26, 56, 221, 65, 204, 165, 64, 201, 72, 230, 236, 35, 42, 6, 97, 195, 238, 61, 210, 35, 86, 136, 221, 118, 122, 167, 78, 70, 130, 250, 160, 209, 228, 163, 7, 165, 236, 39, 165, 130, 220, 177, 217, 44, 229, 243, 105, 225, 163, 25, 243, 34, 226, 2, 241, 169, 224, 33, 107, 27, 136, 117, 236, 99, 19, 101, 54, 180, 134, 186, 241, 129, 228, 20, 182, 78, 95, 134, 131, 55, 18, 4, 101, 171, 43, 162, 107, 151, 213, 17, 83, 200, 17, 66, 9, 16, 78, 180, 83, 239, 205, 95, 175, 49, 136, 214, 96, 102, 79, 212, 252, 114, 224, 220, 120, 154, 89, 140, 46, 167, 153, 182, 188, 18, 103, 4, 197, 255, 166, 149, 192, 88, 195, 191, 22, 35, 120, 74, 206, 130, 104, 142, 173, 238, 131, 177, 96, 230, 164, 93, 115, 99, 161, 202, 33, 23, 63, 131, 68, 49, 246, 211, 21, 47, 91, 205, 32, 43, 242, 143, 96, 166, 181, 174, 80, 162, 144, 240, 243, 206, 83, 33, 141, 110, 237, 11, 120, 152, 195, 110, 225, 254, 147, 223, 184, 204, 134, 21, 233, 47, 56, 84, 86, 66, 147, 74, 61, 9, 148, 83, 30, 20, 81, 194, 237, 185, 85, 51, 214, 106, 231, 117, 121, 103, 136, 127, 32, 52, 16, 91, 32, 85, 29, 209, 1, 81, 77, 252, 233, 103, 48, 203, 223, 239, 137, 81, 196, 91, 192, 157, 236, 8, 75, 34, 251, 90, 190, 108, 95, 32, 214, 237, 155, 101, 184, 225, 156, 168, 151, 124, 16, 91, 150, 76, 226, 96, 168, 18, 235, 219, 19, 60, 148, 38, 133, 40, 19, 184, 43, 187, 163, 78, 213, 207, 81, 66, 78, 197, 175, 109, 233, 217, 34, 161, 65, 233, 42, 102, 207, 178, 230, 65, 0, 69, 165, 161, 252, 216, 167, 255, 0, 0, 0, 5, 233, 50, 99, 183, 45, 181, 216, 163, 112, 126, 145, 73, 167, 40, 151, 39, 140, 132, 231, 99, 167, 161, 93, 114, 31, 165, 208, 100, 196, 77, 91, 174, 250, 240, 128, 35, 67, 203, 233, 130, 111, 252, 196, 89, 168, 58, 6, 145, 32, 37, 53, 201, 95, 196, 208, 167, 149, 21, 53, 56, 167, 223, 114, 165, 60, 0, 73, 85, 208, 119, 242, 183, 164, 101, 140, 28, 183, 68, 47, 66, 148, 253, 173, 35, 36, 99, 147, 189, 145, 29, 176, 195, 82, 132, 48, 117, 216, 210, 123, 76, 155, 133, 111, 112, 198, 112, 187, 107, 244, 162, 62, 76, 245, 47, 82, 62, 21, 237, 116, 163, 246, 74, 30, 154, 233, 120, 142, 35, 113, 23, 92, 44, 105, 196, 217, 41, 191, 158, 65, 179, 174, 106, 141, 13, 63, 166, 109, 4, 183, 94, 70, 247, 184, 24, 7, 27, 201, 231, 127, 189]},
		LmsTest{ test_passed: true, signature: &[0, 0, 0, 9, 0, 0, 0, 4, 83, 210, 46, 218, 114, 227, 67, 106, 208, 173, 49, 86, 23, 242, 244, 157, 96, 17, 243, 51, 210, 214, 91, 203, 255, 75, 181, 136, 35, 226, 25, 73, 71, 0, 187, 164, 0, 159, 150, 204, 38, 146, 194, 188, 155, 106, 105, 101, 164, 0, 125, 35, 3, 209, 172, 174, 90, 14, 130, 90, 106, 95, 70, 231, 209, 101, 187, 44, 212, 9, 221, 121, 139, 126, 21, 237, 235, 212, 95, 250, 63, 189, 1, 65, 244, 51, 161, 197, 164, 237, 130, 228, 212, 88, 204, 139, 145, 49, 120, 210, 212, 25, 118, 135, 0, 210, 251, 166, 10, 164, 100, 61, 202, 238, 201, 185, 133, 100, 247, 95, 117, 198, 253, 109, 157, 197, 212, 35, 224, 86, 138, 91, 108, 159, 59, 107, 63, 224, 42, 55, 8, 132, 168, 125, 43, 246, 17, 78, 74, 84, 149, 142, 25, 45, 58, 101, 169, 123, 7, 254, 151, 199, 233, 221, 155, 28, 250, 100, 157, 125, 100, 165, 124, 240, 86, 205, 1, 23, 164, 238, 207, 132, 204, 102, 114, 139, 233, 66, 116, 181, 60, 183, 167, 114, 219, 40, 85, 26, 210, 23, 179, 145, 155, 117, 50, 127, 170, 69, 131, 75, 12, 226, 97, 143, 93, 235, 141, 63, 65, 33, 132, 185, 235, 200, 53, 243, 63, 228, 186, 185, 57, 197, 19, 139, 81, 102, 78, 62, 104, 11, 84, 151, 89, 57, 247, 103, 100, 247, 134, 166, 142, 247, 21, 244, 57, 49, 43, 12, 215, 154, 53, 76, 180, 110, 204, 65, 200, 53, 25, 210, 152, 177, 97, 104, 94, 111, 120, 40, 254, 32, 235, 176, 16, 238, 192, 178, 121, 108, 210, 19, 181, 39, 111, 90, 23, 3, 137, 215, 74, 79, 243, 115, 197, 55, 34, 134, 29, 207, 55, 105, 24, 72, 94, 168, 84, 85, 174, 90, 147, 137, 2, 56, 202, 80, 32, 25, 220, 162, 251, 183, 16, 143, 193, 43, 54, 89, 248, 21, 170, 98, 136, 227, 187, 173, 239, 137, 177, 107, 88, 208, 194, 34, 111, 64, 16, 52, 145, 92, 232, 247, 182, 46, 41, 10, 84, 34, 166, 134, 165, 132, 168, 71, 24, 251, 142, 10, 17, 220, 97, 55, 146, 19, 64, 13, 137, 192, 214, 54, 114, 128, 222, 163, 4, 215, 80, 2, 74, 238, 96, 52, 203, 242, 90, 168, 92, 130, 238, 154, 118, 159, 73, 19, 145, 167, 73, 79, 254, 95, 62, 75, 249, 86, 204, 63, 222, 149, 174, 63, 239, 43, 169, 0, 8, 145, 109, 219, 125, 74, 114, 29, 14, 55, 161, 96, 242, 64, 66, 229, 7, 48, 174, 92, 72, 126, 102, 155, 79, 204, 74, 119, 18, 181, 111, 219, 216, 197, 178, 200, 203, 45, 242, 228, 120, 74, 161, 186, 226, 6, 54, 142, 169, 93, 73, 171, 43, 238, 50, 173, 202, 137, 157, 187, 106, 118, 200, 34, 185, 215, 244, 107, 23, 81, 214, 153, 82, 230, 29, 8, 20, 197, 95, 114, 249, 172, 107, 44, 186, 67, 144, 50, 229, 44, 72, 0, 206, 96, 104, 162, 42, 13, 81, 35, 63, 32, 199, 16, 100, 131, 124, 58, 131, 108, 143, 170, 19, 217, 218, 249, 144, 221, 43, 135, 122, 238, 152, 77, 217, 118, 127, 51, 57, 232, 112, 142, 235, 85, 45, 154, 8, 142, 171, 60, 32, 190, 239, 110, 128, 105, 56, 34, 119, 228, 208, 219, 139, 142, 127, 72, 150, 178, 95, 224, 174, 146, 75, 47, 122, 236, 192, 128, 127, 128, 166, 226, 2, 252, 170, 135, 136, 200, 137, 235, 125, 86, 157, 174, 48, 115, 169, 164, 241, 220, 96, 192, 184, 52, 161, 75, 99, 208, 94, 50, 95, 156, 217, 162, 32, 255, 188, 208, 25, 70, 85, 227, 42, 129, 164, 159, 115, 68, 37, 235, 202, 179, 217, 89, 12, 215, 160, 14, 191, 109, 3, 3, 146, 100, 242, 136, 46, 161, 95, 213, 107, 162, 208, 164, 75, 12, 209, 86, 187, 13, 56, 106, 13, 238, 109, 118, 115, 171, 170, 149, 70, 137, 161, 55, 118, 41, 105, 74, 10, 230, 141, 63, 88, 199, 56, 52, 175, 130, 203, 38, 171, 199, 157, 173, 64, 55, 166, 171, 154, 201, 125, 38, 154, 240, 86, 68, 83, 5, 175, 80, 138, 66, 166, 86, 72, 235, 10, 24, 74, 215, 161, 142, 253, 151, 79, 120, 43, 105, 174, 219, 58, 194, 136, 33, 59, 204, 197, 230, 66, 45, 253, 50, 189, 255, 22, 117, 19, 64, 118, 220, 25, 43, 38, 97, 25, 23, 130, 202, 255, 11, 200, 165, 203, 103, 153, 251, 95, 75, 213, 14, 181, 186, 149, 242, 230, 171, 196, 115, 14, 138, 163, 225, 148, 68, 72, 5, 241, 170, 214, 84, 140, 21, 99, 124, 158, 60, 232, 129, 253, 10, 164, 71, 115, 57, 196, 150, 29, 69, 79, 225, 108, 246, 158, 1, 197, 255, 231, 116, 172, 203, 31, 221, 49, 11, 57, 227, 191, 53, 61, 204, 37, 104, 254, 212, 29, 69, 107, 102, 9, 89, 193, 151, 68, 17, 192, 137, 127, 64, 23, 88, 166, 8, 221, 8, 254, 18, 10, 64, 113, 241, 222, 86, 112, 231, 6, 86, 92, 132, 135, 230, 178, 66, 75, 2, 180, 210, 163, 192, 238, 60, 162, 96, 248, 10, 132, 189, 63, 60, 144, 215, 162, 204, 22, 86, 118, 29, 211, 20, 164, 38, 202, 31, 171, 192, 148, 233, 217, 107, 147, 193, 224, 72, 125, 205, 214, 215, 209, 196, 165, 169, 53, 49, 45, 80, 95, 160, 102, 155, 42, 202, 39, 43, 101, 106, 138, 193, 217, 143, 243, 194, 36, 117, 178, 222, 181, 16, 124, 248, 220, 44, 77, 246, 23, 121, 136, 44, 51, 226, 70, 97, 171, 53, 252, 124, 49, 126, 72, 78, 248, 162, 120, 142, 135, 156, 165, 109, 48, 78, 202, 81, 237, 250, 119, 172, 72, 204, 105, 243, 125, 139, 217, 59, 1, 162, 63, 156, 195, 44, 205, 212, 249, 76, 79, 84, 82, 225, 69, 219, 191, 156, 181, 162, 224, 29, 70, 31, 185, 53, 217, 57, 66, 67, 202, 246, 114, 177, 10, 48, 88, 248, 84, 237, 254, 201, 105, 132, 246, 150, 130, 124, 26, 205, 203, 159, 52, 69, 224, 194, 78, 30, 125, 51, 23, 34, 128, 132, 231, 226, 65, 211, 177, 206, 24, 143, 147, 67, 60, 80, 236, 178, 209, 188, 103, 154, 31, 61, 130, 5, 41, 123, 33, 86, 123, 128, 215, 101, 89, 88, 248, 181, 90, 171, 22, 72, 19, 102, 192, 166, 0, 0, 0, 5, 158, 178, 154, 58, 195, 176, 176, 138, 115, 205, 18, 116, 21, 102, 86, 150, 172, 197, 77, 201, 113, 203, 101, 43, 164, 30, 55, 124, 54, 246, 72, 202, 151, 140, 150, 11, 46, 235, 242, 223, 50, 103, 35, 214, 150, 199, 143, 232, 111, 140, 43, 113, 113, 165, 172, 57, 69, 51, 208, 20, 117, 23, 93, 13, 50, 157, 237, 173, 35, 97, 206, 32, 77, 45, 179, 228, 206, 33, 219, 87, 89, 165, 77, 229, 226, 51, 209, 212, 207, 174, 165, 48, 0, 172, 201, 224, 216, 210, 123, 76, 155, 133, 111, 112, 198, 112, 187, 107, 244, 162, 62, 76, 245, 47, 82, 62, 21, 237, 116, 163, 246, 74, 30, 154, 233, 120, 142, 35, 113, 23, 92, 44, 105, 196, 217, 41, 191, 158, 65, 179, 174, 106, 141, 13, 63, 166, 109, 4, 183, 94, 70, 247, 184, 24, 7, 27, 201, 231, 127, 189]},
	];
	for t in TESTS {
        let (head, thing2, _tail): (&[u8], &[LmsSignature<8, 34, 5>], &[u8]) =
            unsafe { t.signature.align_to::<LmsSignature<8, 34, 5>>() };

        assert!(head.is_empty());
        let lms_sig = thing2[0];
        let verify_result = Lms::default().verify_lms_signature_generic(
            &mut sha256,
            &MESSAGE,
            &lms_public_key,
            &lms_sig,
        );
        if t.test_passed {
            // if the test is supposed to pass then we better have no errors and a successful verification
            let result = verify_result.unwrap();
            assert_eq!(result, LmsResult::Success)
        } else {
            // if the test is supposed to fail it could be for a number of reasons that could raise a variety of errors
            // if the verification didn't error, then extract the LMS result and ensure it is a failed verification
            if verify_result.is_ok() {
                let result = verify_result.unwrap();
                assert_eq!(result, LmsResult::SigVerifyFailed)
            }
        }
    }
}

test_suite! {
    test_lms_random_suite,
}
